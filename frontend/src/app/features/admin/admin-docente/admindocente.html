<div class="admin-docente-container">
  <h2>Gestión de Docentes</h2>
  
  <!-- Mensaje de éxito o error -->
  @if (mensaje) {
    <div class="alert alert-success">{{ mensaje }}</div>
  }
  
  @if (error) {
    <div class="alert alert-danger">{{ error }}</div>
  }
  
  <!-- Botones de acción principal -->
  <div class="acciones-container">
    <button class="btn btn-primary" (click)="toggleMostrarUsuarios()">
      {{ mostrarUsuariosRegulares ? 'Ver Docentes' : 'Asignar Rol Docente' }}
    </button>
  </div>
  
  <!-- Indicador de carga -->
  @if (loading) {
    <div class="spinner">Cargando...</div>
  }

  <!-- Lista de docentes actuales con búsqueda -->
  @if (!mostrarUsuariosRegulares && !loading && !error) {
    <div class="docentes-container">
      <h3>Docentes Actuales</h3>
      
      <!-- Filtros de búsqueda -->
      <div class="filtros-container">
        <div class="busqueda">
          <input 
            type="text" 
            placeholder="Buscar por nombre, email o legajo..." 
            (input)="onSearch($any($event.target).value)" 
            class="search-input"
          >
        </div>
        
        <div class="filtros">
          <select (change)="filtrarPorEstado($any($event.target).value)">
            <option value="">Todos los estados</option>
            <option value="Activo">Activo</option>
            <option value="Inactivo">Inactivo</option>
          </select>
          
          <select (change)="filtrarPorArea($any($event.target).value)">
            <option value="">Todas las Areas</option>
            <option value="Matemáticas">Matemáticas</option>
            <option value="Ciencias Naturales">Ciencias Naturales</option>
            <option value="Ciencias Sociales">Ciencias Sociales</option>
            <option value="Lengua">Lengua</option>
            <option value="LLengua extranjera">Lengua extranjera</option>

          </select>
        </div>
      </div>
      
      <!-- Tabla de resultados -->
      <table class="table">
        <thead>
          <tr>
            <th>Nombre</th>
            <th>Email</th>
            <th>Legajo</th>
            <th>Área</th>
            <th>Estado</th>
            <th>Acciones</th>
          </tr>
        </thead>
        <tbody>
          @for (docente of docentes; track docente.id) {
            <tr>
              <td>{{ docente.nombre }}</td>
              <td>{{ docente.email }}</td>
              <td>{{ docente.legajo }}</td>
              <td>{{ docente.area || 'No asignada' }}</td>
              <td>{{ docente.estado }}</td>
              <td class="actions-cell">
                <button class="btn btn-sm btn-info" (click)="asignarMateria(docente.id)">
                  Asignar Materia
                </button>
                
                <button class="btn btn-sm btn-danger admin-btn" 
                        (click)="promoverAAdmin(docente.id, docente.nombre)">
                  Promover a Admin
                </button>
              </td>
            </tr>
          } @empty {
            <tr>
              <td colspan="6" class="text-center">
                {{ terminoBusqueda ? 'No se encontraron docentes con ese criterio' : 'No hay docentes registrados' }}
              </td>
            </tr>
          }
        </tbody>
      </table>
      
      <!-- Paginación simple -->
      @if (docentes.length > 0) {
        <div class="pagination">
          <button 
            [disabled]="currentPage === 1" 
            (click)="cambiarPagina(currentPage - 1)"
          >
            Anterior
          </button>
          <span>Página {{ currentPage }}</span>
          <button (click)="cambiarPagina(currentPage + 1)">
            Siguiente
          </button>
        </div>
      }
    </div>
  }

  <!-- Vista para asignar roles de docente -->
  @if (mostrarUsuariosRegulares && !loading && !error) {
    <div class="usuarios-container">
      <h3>Usuarios Registrados</h3>
      <p>Selecciona los usuarios a los que deseas asignar el rol de docente:</p>
      
      <table class="table">
        <thead>
          <tr>
            <th>Nombre</th>
            <th>Email</th>
            <th>Legajo</th>
            <th>Fecha Registro</th>
            <th>Acciones</th>
          </tr>
        </thead>
        <tbody>
          @for (usuario of usuariosRegulares; track usuario.id) {
            <tr>
              <td>{{ usuario.name }}</td>
              <td>{{ usuario.email }}</td>
              <td>{{ usuario.legajo || 'No asignado' }}</td>
              <td>{{ usuario.created_at | date }}</td>
              <td>
                <div class="btn-group">
                  <button class="btn btn-sm btn-primary" (click)="asignarRolDocente(usuario.id)">
                    Convertir a Docente
                  </button>
                </div>
              </td>
            </tr>
          } @empty {
            <tr>
              <td colspan="5" class="text-center">No hay usuarios disponibles para asignar</td>
            </tr>
          }
        </tbody>
      </table>
    </div>
  }
</div>