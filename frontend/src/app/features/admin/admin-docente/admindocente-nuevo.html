<div class="docentes-container">
  <!-- Panel Principal -->
  <div class="panel-principal">
    <div class="panel-header">
      <div class="header-content">
        <h2 class="panel-title">
          <i class="fas fa-user-tie me-2"></i>Gestión de Docentes
        </h2>
        <p class="panel-subtitle">Administra los docentes del sistema</p>
      </div>
    </div>

    <!-- Alertas -->
    @if (mensaje) {
      <div class="alert alert-success">
        <i class="fas fa-check-circle"></i> {{ mensaje }}
      </div>
    }

    @if (error) {
      <div class="alert alert-danger">
        <i class="fas fa-exclamation-triangle"></i> {{ error }}
      </div>
    }

    <!-- Estado de carga -->
    @if (loading) {
      <div class="loading-state">
        <div class="spinner"></div>
        <p>Cargando docentes...</p>
      </div>
    }

    <!-- Sin docentes -->
    @if (!loading && docentes.length === 0 && !terminoBusqueda) {
      <div class="empty-state">
        <div class="empty-icon">
          <i class="fas fa-user-tie"></i>
        </div>
        <h3>No hay docentes registrados</h3>
        <p>Aún no existen docentes en el sistema.</p>
      </div>
    }

    <!-- Grid de docentes -->
    @if (!loading && docentes.length > 0) {
      <!-- Filtros de búsqueda -->
      <div class="filtros-section">
        <div class="search-bar">
          <i class="fas fa-search"></i>
          <input 
            type="text"
            class="search-input"
            placeholder="Buscar por nombre, email o legajo..."
            [(ngModel)]="terminoBusqueda"
            (ngModelChange)="onSearch(terminoBusqueda)">
        </div>
        
        <div class="filtros-group">
          <select class="filter-select" [(ngModel)]="estadoFiltro" (change)="filtrarPorEstado(estadoFiltro)">
            <option value="">Todos los estados</option>
            <option value="Activo">Activo</option>
            <option value="Inactivo">Inactivo</option>
          </select>
        </div>
      </div>

      <div class="docentes-grid">
        @for (docente of docentes; track docente.id) {
          <div class="docente-card">
            <div class="card-header">
              <div class="docente-avatar">
                {{ docente.nombre.charAt(0).toUpperCase() }}
              </div>
              <div class="docente-info-header">
                <h4 class="docente-nombre">{{ docente.nombre }}</h4>
                <span class="docente-legajo">{{ docente.legajo }}</span>
              </div>
              <span class="badge" [class.badge-success]="docente.estado === 'Activo'" 
                                  [class.badge-secondary]="docente.estado === 'Inactivo'">
                {{ docente.estado }}
              </span>
            </div>
            
            <div class="card-body">
              <div class="info-item">
                <i class="fas fa-envelope"></i>
                <span>{{ docente.email }}</span>
              </div>
              
              @if (docente.area) {
                <div class="info-item">
                  <i class="fas fa-graduation-cap"></i>
                  <span>{{ docente.area }}</span>
                </div>
              }
              
              <div class="stats-row">
                <div class="stat-item">
                  <i class="fas fa-book"></i>
                  <span>{{ docente.cantidadMaterias || 0 }} materias</span>
                </div>
                <div class="stat-item">
                  <i class="fas fa-user-graduate"></i>
                  <span>{{ docente.cantidadEstudiantes || 0 }} estudiantes</span>
                </div>
              </div>
            </div>
            
            <div class="card-actions">
              <button class="btn btn-sm btn-outline-primary" 
                      (click)="editarDocente(docente)"
                      title="Editar información del docente">
                <i class="fas fa-user-edit"></i> Editar Información
              </button>
              
              <button class="btn btn-sm btn-outline-danger" 
                      (click)="promoverAAdmin(docente.id, docente.nombre)"
                      title="Promover a administrador">
                <i class="fas fa-user-shield"></i> Promover
              </button>
            </div>
          </div>
        } @empty {
          <div class="empty-search">
            <i class="fas fa-search"></i>
            <p>No se encontraron docentes con "{{ terminoBusqueda }}"</p>
          </div>
        }
      </div>
    }
  </div>
</div>

<!-- Modal para editar docente -->
@if (mostrarModalEdicion) {
  <div class="modal-overlay">
    <div class="modal-container">
      <div class="modal-header">
        <h3>
          <i class="fas fa-user-edit me-2"></i>
          Editar Información del Docente
        </h3>
        <button type="button" class="modal-close" (click)="cerrarModal()">
          <i class="fas fa-times"></i>
        </button>
      </div>
      
      <div class="modal-body">
        @if (docenteEditando) {
          <form [formGroup]="formularioEdicion" (ngSubmit)="guardarCambios()">
            <div class="form-grid">
              <!-- Información Personal -->
              <div class="form-section">
                <h4 class="section-title">
                  <i class="fas fa-user"></i> Información Personal
                </h4>
                
                <div class="form-row">
                  <div class="form-group">
                    <label for="nombre">Nombre *</label>
                    <input 
                      type="text" 
                      id="nombre"
                      class="form-control" 
                      formControlName="nombre"
                      placeholder="Ingrese el nombre">
                  </div>
                  
                  <div class="form-group">
                    <label for="apellido">Apellido *</label>
                    <input 
                      type="text" 
                      id="apellido"
                      class="form-control" 
                      formControlName="apellido"
                      placeholder="Ingrese el apellido">
                  </div>
                </div>
                
                <div class="form-row">
                  <div class="form-group">
                    <label for="dni">DNI *</label>
                    <input 
                      type="text" 
                      id="dni"
                      class="form-control" 
                      formControlName="dni"
                      placeholder="12345678"
                      maxlength="8">
                  </div>
                  
                  <div class="form-group">
                    <label for="fechaNacimiento">Fecha de Nacimiento *</label>
                    <input 
                      type="date" 
                      id="fechaNacimiento"
                      class="form-control" 
                      formControlName="fechaNacimiento">
                  </div>
                </div>
              </div>
              
              <!-- Información de Contacto -->
              <div class="form-section">
                <h4 class="section-title">
                  <i class="fas fa-address-book"></i> Información de Contacto
                </h4>
                
                <div class="form-row">
                  <div class="form-group">
                    <label for="email">Correo Electrónico *</label>
                    <input 
                      type="email" 
                      id="email"
                      class="form-control" 
                      formControlName="email"
                      placeholder="usuario@ejemplo.com">
                  </div>
                  
                  <div class="form-group">
                    <label for="telefono">Teléfono *</label>
                    <input 
                      type="tel" 
                      id="telefono"
                      class="form-control" 
                      formControlName="telefono"
                      placeholder="Ingrese su teléfono"
                      maxlength="15">
                  </div>
                </div>
                
                <div class="form-row">
                  <div class="form-group form-group-full">
                    <label for="domicilio">Domicilio *</label>
                    <input 
                      type="text" 
                      id="domicilio"
                      class="form-control" 
                      formControlName="domicilio"
                      placeholder="Ingrese su domicilio">
                  </div>
                </div>
              </div>
              
              <!-- Información Académica -->
              <div class="form-section">
                <h4 class="section-title">
                  <i class="fas fa-graduation-cap"></i> Información Académica
                </h4>
                
                <div class="form-row">
                  <div class="form-group">
                    <label for="legajo">Legajo *</label>
                    <input 
                      type="text" 
                      id="legajo"
                      class="form-control" 
                      formControlName="legajo"
                      placeholder="Ingrese su legajo">
                  </div>
                  
                  <div class="form-group">
                    <label for="estado">Estado</label>
                    <select id="estado" class="form-control" formControlName="estado">
                      <option value="Activo">Activo</option>
                      <option value="Inactivo">Inactivo</option>
                    </select>
                  </div>
                </div>
                
                <div class="form-row">
                  <div class="form-group form-group-full">
                    <label for="area">Área de Especialización</label>
                    <input 
                      type="text" 
                      id="area"
                      class="form-control" 
                      formControlName="area"
                      placeholder="Ej: Matemática, Historia, etc.">
                  </div>
                </div>
              </div>
            </div>
            
            <!-- Alertas del modal -->
            @if (mensajeModal) {
              <div class="alert alert-success">
                <i class="fas fa-check-circle"></i> {{ mensajeModal }}
              </div>
            }
            
            @if (errorModal) {
              <div class="alert alert-danger">
                <i class="fas fa-exclamation-triangle"></i> {{ errorModal }}
              </div>
            }
            
            <!-- Botones del modal -->
            <div class="modal-footer">
              <button type="button" class="btn btn-secondary" (click)="cerrarModal()">
                <i class="fas fa-times"></i> Cancelar
              </button>
              <button type="submit" class="btn btn-primary" [disabled]="!formularioEdicion.valid || guardandoCambios">
                <i class="fas fa-save"></i>
                @if (guardandoCambios) {
                  <span class="spinner-border spinner-border-sm me-1"></span>
                  Guardando...
                } @else {
                  Guardar Cambios
                }
              </button>
            </div>
          </form>
        }
      </div>
    </div>
  </div>
}
